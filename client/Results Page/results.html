<template name="results">
	{{#if results}}
	<div class="row">
		<div class="col-md-2">{{> minPrice}}<br/>{{> buy}}<br/>{{> relaunch}}<br/>{{>options}}</div>
		<div class="col-md-10">
				<div class="row">
				<div class="col-md-6">
					{{#if gotLiveFlight}}
						{{>tripDays}}	
					{{/if}}
				</div>
				<div class="col-md-3">
					{{> minFlight}}
				</div>
				{{#if hasCar}}
					<div class="col-md-3">
						{{> minCar}}
					</div>
				{{/if}}
			</div>
			<div class="row">
				{{> minHotel}}
			</div>
		</div>
	</div>
	{{/if}}
</template>

<template name="relaunch">
	<div>
		<button type="submit" class="optimizeButton" name="refreshResults">Re-Optimize</button>
	</div>
</template>

<template name="buy">
	<div>
		<button type="button" class="buyButton" name="Buy">BUY</button>
	</div>
</template>

<template name="minPrice">
	<div class="panel panel-primary">
		<div class="panel-heading"><h1>{{minTotalPrice}} {{symbolCurrency}}</h1></div>
		<div class="panel-body">
			For {{nbPersons}} adults :
			<h4>Flight: {{minFlightPrice}} {{symbolCurrency}}</h4>
			{{#if hasCar}}
				<h4>Car Rental : {{minCarPrice}} {{symbolCurrency}}</h4>
			{{/if}}
			<h4>Hotel Total : {{minHotelPrices}} {{symbolCurrency}}</h4></div>
		</div>
</template>

<template name="minFlight">
	<div class="panel panel-default">
		<div class="panel-heading">Flight</div>
		<div class="panel-body">
			{{#with minLiveFlight}}
				{{#with fare}}
					<!--{{#with Agents}}
						<img border="0" height="60" width="120" hspace="0" class="img-rounded" src="{{ImageUrl}}"/>
					{{/with}}-->
					<h3>{{total_price}} {{symbolCurrency}}</h3>
				{{/with}}
				<br/>
				<ul class="nav nav-tabs" role="tablist">
					<li role="presentation" class="active"><a href="#outbound" aria-controls="home" role="tab" data-toggle="tab">Outbound</a></li>
					<li role="presentation"><a href="#inbound" aria-controls="home" role="tab" data-toggle="tab">Inbound</a></li>
				</ul>
				<br/>
				{{#with getFirstItinerary}}
					<div class="tab-content">
						<div role="tabpanel" class="tab-pane fade in active" id="outbound">
							{{#with outbound}}
								{{>leg}}
							{{/with}}
						</div>
						<div role="tabpanel" class="tab-pane fade" id="inbound">
							{{#with inbound}}
								{{>leg}}
							{{/with}}
						</div>
					</div>
					<br/>
				{{/with}}
			{{/with}}
			{{>displayAllFlight}}
		</div>
	</div>
</template>

<template name="displayAllFlight">
	<button class="btn btn-info" type="button" name="otherFlights" data-toggle="modal" data-target="#myModal">Other Flights</button>
	<!-- Modal -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h4 class="modal-title" id="myModalLabel">Flights</h4>
	      </div>
	      <div class="modal-body">
	      	{{#each allItineraries}}
	      		<div class="well">
	      			{{#with fare}}
	      				<h3>Price : {{total_price}}{{symbolCurrency}}</h3>
	      			{{/with}}
	      			{{#each itineraries}}
		      			<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active"><a href="#{{OutboundLegId}}" aria-controls="home" role="tab" data-toggle="tab">Outbound</a></li>
							<li role="presentation"><a href="#{{InboundLegId}}" aria-controls="home" role="tab" data-toggle="tab">Inbound</a></li>
						</ul>
						<br/>
						<div class="tab-content">
							<div role="tabpanel" class="tab-pane fade in active" id="{{OutboundLegId}}">
								{{>displayLeg leg=this.outbound}}
							</div>
							<div role="tabpanel" class="tab-pane fade" id="{{InboundLegId}}">
								{{>displayLeg leg=this.inbound}}
							</div>
						</div>
						<br/>
					{{/each}}
	      		</div>
	      	{{/each}}
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div>
	  </div>
	</div>
</template>

<template name="displayLeg">
	{{#with getLeg leg}}
		{{#each flights}}
			Departure at {{getDepTime departs_at}} on {{getDepDate departs_at}} from 
			{{#with origin}}
				<b>{{airport}}</b>
			{{/with}}<br/>
			<br/>
			Arrival at {{getDepTime arrives_at}} on {{getDepDate arrives_at}} to 
			{{#with destination}}
				<b>{{airport}}</b>
			{{/with}}<br/>
			Aircraft : {{aircraft}}
			Operating airline : {{operating_airline}}
			Marketing airline : {{marketing_airline}}
			Flight number : {{flight_number}}
			{{#with booking_info}}
				Class : {{travel_class}}
			{{/with}}
		{{/each}}
	{{/with}}
	<br/>
</template>

<template name="leg">
	{{#each flights}}
		{{#with newOperatingCarrier}}
			<img border="0" height="45" width="90" hspace="0" class="img-rounded" src="{{ImageUrl}}"/>
		{{/with}}
		<br/>
		Flight Number : {{operating_airline}}{{flight_number}}
		Aircraft : {{aircraft}}
		<br/><br/>
		{{getDepDate}}<br/>
		Leaving at {{getDepTime}}<br/>
		{{#with origin}}
			<b>{{airport}}</b>
		{{/with}}<br/>
		Landing at {{getArrTime}}<br/>
		{{#with destination}}
			<b>{{airport}}</b>
		{{/with}}
		<br/>
	{{/each}}
</template>
	
<template name="minCar">
	<div class="panel panel-default">
		<div class="panel-heading">Car</div>
		<div class="panel-body">
			{{#with minVehicle}}
				{{#with cars}}
					{{#with estimated_total}}
						<h3>{{amount}}{{symbolCurrency}}</h3>
					{{/with}}
				{{/with}}<br/>
				{{#with provider}}
					Renting company : {{company_code}}, {{company_name}}
				{{/with}}<br/>
				{{#with address}}
					Address : {{line1}}, {{city}}
				{{/with}}
				{{#with vehicule_info}}
					<h4>{{category}} {{manual}}</h4>
				{{/with}}
				<br/>
			{{/with}}<br/>
			{{>displayAllCars}}
		</div>
	</div>	
</template>

<template name="displayAllCars">
	<button class="btn btn-info" type="button" name="otherCars" data-toggle="modal" data-target="#myModal2">Other Cars</button>
	<!-- Modal -->
	<div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h4 class="modal-title" id="myModalLabel">Cars</h4>
	      </div>
	      <div class="modal-body">
	      	{{#each allCars}}
	      		<div class="well">
	      			<!-- <img border="0" height="60" width="120" hspace="0" src="{{getWebsiteImage website_id}}"/> -->
	      			<h4>Price : {{price_all_days}} {{symbolCurrency}}</h4>
	      			<br/>
	      			<img border="0" height="60" width="120" hspace="0" src="{{getCarImage image_id}}"/>
					{{vehicle}}<br/>
	      			{{#with location}}
	      				{{#with pick_up}}
	      					address : {{address}}
	      				{{/with}}
	      			{{/with}}<br/>
	      			<button class="btn btn-success carSelection" type="button" >Select</button>
	      		</div>
	      	{{/each}}
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div>
	  </div>
	</div>
</template>
		
<template name="minHotel">
	<div class="panel panel-default">
		<div class="panel-heading">Hotels </div>
			<div class="panel-body">
				{{#each minHotels}}
					{{#with results}}
						<div class="col-sm-6 col-md-4">
							<div class="thumbnail">
								<div class="caption">
									{{#with address}}
										<h3>{{city}}</h3>
										<h4>{{property_name}}
										{{#each getStars property_code}}	
											<img height="15" width="15" hspace="0" src="/star_PNG1597.png"/>
										{{/each}}</h4>
									{{/with}}
									<p>
										{{#with total_price}}
											<h4>{{amount}}{{currency}}</h4>
										{{/with}}
										{{#with address}}
											<i>{{line1}}, {{city}} in {{country}} </i><br/>
										{{/with}}
										<a class="btn btn-primary" role="button" data-toggle="collapse" href="#{{hotel_id}}" aria-expanded="false" aria-controls="{{hotel_id}}">
											Details
										</a>
										<div class="collapse" id="{{hotel_id}}">
											<div class="well">
												<b>Description :</b>
												{{marketing_text}}<br/>
												<b>Amenities :</b>
												{{#each amenities}}
													{{description}}
												{{/each}}
											</div>
										</div>
										<br/>
										<!--{{>displayAllHotels param = this}}-->
									</p>
								</div>
							</div>
						</div>
					{{/with}}
				{{/each}}
			</div>
		</div>
</template>

<template name="displayAllHotels">
	<button class="btn btn-info" type="button" name="otherHotels" data-toggle="modal" data-target="{{getIDDiased param}}">Other Hotels</button>
	<!-- Modal -->
	<div class="modal fade" id="{{getIdNotDiased param}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h4 class="modal-title" id="myModalLabel">Hotels</h4>
	      </div>
	      <div class="modal-body">
	      	{{#with allHotels param}}
		      	<div class="well">
		      		{{#each hotels}}
		      			<img border="10" height="100%" width="100%" hspace="0" src="{{getFirstImage this}}"/>
		      			<h2>{{name}}</h2>
		      		{{/each}}
		      		{{#each hotels_prices}}
				      	<table class="table table-striped">
				      		<th>Agent</th>
				      		<th>Price</th>
					      		{{#each agent_prices}}
					      			<tr>
					      			<td><img border="0" height="45" width="90" hspace="0" class="img-rounded" src="{{getAgentImage id}}"/></td>
					      			<td><b>{{price_total}}{{symbolCurrency}}</b></td>
					      			</tr>
					      		{{/each}}
				      			<button class="btn btn-success hotelSelection" type="button" >Select</button>
			      		</table>
			      	{{/each}}
			    </div>
	      	{{/with}}
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div>
	  </div>
	</div>
</template>

<template name="options">
	<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
	  <div class="panel panel-default">
	    <div class="panel-heading" role="tab" id="headingOne">
	      <h4 class="panel-title">
	        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
		        Flight Options
	        </a>
	      </h4>
	    </div>
	    <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
	      {{> nbStops}}
	      {{> tripLength}}
	      {{> depAirport}}
	    </div>
	  </div>
	  {{#if hasCar}}
		  <div class="panel panel-default">
		    <div class="panel-heading" role="tab" id="headingTwo">
		      <h4 class="panel-title">
		        <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
		        	Car Options
		        </a>
		      </h4>
		    </div>
		    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
		      <div class="panel-body">
		      	{{> carAgents}}
		      </div>
		    </div>
		  </div>
	  {{/if}}
	  <div class="panel panel-default">
	    <div class="panel-heading" role="tab" id="headingThree">
	      <h4 class="panel-title">
	        <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
	          Hotel Options
	        </a>
	      </h4>
	    </div>
	    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
	      <div class="panel-body">
	        blabla 3
	      </div>
	    </div>
	  </div>
	</div>
</template>

<template name="tripDays">
	{{> fullcalendar id="myCalendar"}}
</template>

<template name='nbStops'>
	<div class="list-group">
		<b>Number of Stops :</b><br/>
		<input type="checkbox" class="flightLegOption" id="direct" checked>Direct flight<br/>
		<input type="checkbox" class="flightLegOption" id="oneStop" checked>1 stop<br/>
		<input type="checkbox" class="flightLegOption" id="twoStops" checked>2+ stops<br/>
	</div><br/>
</template>

<template name='tripLength'>
	<b>Duration Range :</b><br/>
	<input type="rangeslide" id="durationFlight"/>
	<br/>
</template>

<template name="depAirport">
	<div class="airport-group">
		<b>Departure Airports :</b><br/>
		{{#each depAirports}}
			<input type="checkbox" name="airportSelected" id="{{Code}}" checked>{{airport}}<br/>
		{{/each}}
	</div><br/>
</template>

<template name="carAgents">
	<b>Agents :</b><br/>
	<div class='carAgentGroup'>
		{{#each allAgents}}
			<input type="checkbox" name="agentSelected" id="{{id}}" checked>{{name}}<br/>
		{{/each}}
	</div>
</template>